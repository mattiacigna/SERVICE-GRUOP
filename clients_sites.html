{% extends "_layout.html" %}
{% block content %}
<div class="row g-3">
  <div class="col-lg-5">
    <div class="card p-4">
      <h5>Aggiungi Cliente</h5>
      <form method="post">
        <input type="hidden" name="kind" value="client">
        <div class="mb-2">
          <label class="form-label">Nome</label>
          <input class="form-control" name="name" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Note</label>
          <input class="form-control" name="note">
        </div>
        <button class="btn btn-primary">Salva Cliente</button>
      </form>
    </div>
  </div>
  <div class="col-lg-7">
    <div class="card p-4">
      <h5>Clienti</h5>
      <table class="table align-middle">
        <thead><tr><th>Nome</th><th>Note</th><th class="text-end">Azioni</th></tr></thead>
        <tbody>
        {% for c in clients %}
          <tr>
            <td>{{ c.name }}</td>
            <td>{{ c.note or "" }}</td>
            <td class="text-end">
              <form method="post" action="{{ url_for('delete_clients_sites', kind='client', oid=c.id) }}"
                    onsubmit="return confirm('Eliminare il cliente?')">
                <button class="btn btn-sm btn-outline-danger">Elimina</button>
              </form>
            </td>
          </tr>
        {% else %}
          <tr><td colspan="3" class="text-muted">Nessun cliente</td></tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="row g-3 mt-1">
  <div class="col-lg-5">
    <div class="card p-4">
      <h5>Aggiungi Cantiere</h5>
      <form method="post">
        <input type="hidden" name="kind" value="site">
        <div class="mb-2">
          <label class="form-label">Nome</label>
          <input class="form-control" name="name" required>
        </div>
        <div class="mb-2">
          <label class="form-label">Cliente</label>
          <select class="form-select" name="client_id" required>
            <option value="">—</option>
            {% for c in clients %}
              <option value="{{ c.id }}">{{ c.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="mb-2">
          <label class="form-label">Indirizzo</label>
          <input class="form-control" name="address">
        </div>
        <div class="mb-3">
          <label class="form-label">Confermato</label>
          <select class="form-select" name="is_confirmed">
            <option value="0">No</option>
            <option value="1">Sì</option>
          </select>
        </div>
        <button class="btn btn-primary">Salva Cantiere</button>
      </form>
    </div>
  </div>
  <div class="col-lg-7">
    <div class="card p-4">
      <h5>Cantieri</h5>
      <table class="table align-middle">
        <thead><tr><th>Nome</th><th>Cliente</th><th>Indirizzo</th><th>Confermato</th><th class="text-end">Azioni</th></tr></thead>
        <tbody>
        {% for s in sites %}
          <tr>
            <td>{{ s.name }}</td>
            <td>{{ s.client.name }}</td>
            <td>{{ s.address or "" }}</td>
            <td>
              {% if s.is_confirmed %}<span class="badge bg-success">Sì</span>
              {% else %}<span class="badge bg-secondary">No</span>{% endif %}
            </td>
            <td class="text-end">
              <form method="post" action="{{ url_for('delete_clients_sites', kind='site', oid=s.id) }}"
                    onsubmit="return confirm('Eliminare il cantiere?')">
                <button class="btn btn-sm btn-outline-danger">Elimina</button>
              </form>
            </td>
          </tr>
        {% else %}
          <tr><td colspan="5" class="text-muted">Nessun cantiere</td></tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
